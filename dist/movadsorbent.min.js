"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(t[a]=o[a])}return t},_createClass=function(){function t(t,e){for(var o=0;o<e.length;o++){var a=e[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,o,a){return o&&t(e.prototype,o),a&&t(e,a),e}}(),Movadsorbent=function(){function t(e,o,a){_classCallCheck(this,t),this.lastStop={left:0,bottom:0},this.curStop={left:0,bottom:0},this.player=e,this.showNote=o,this.event=a,this.$ap=e.container,this.$apBody=e.container.querySelector(".aplayer-body"),this.$apList=e.container.querySelector(".aplayer-list"),this.initPlayerStyle(),this.initControllerBar(),this.initNote(),this.initPlayerEvent(),this.consoleInfo()}return _createClass(t,[{key:"initPlayerStyle",value:function(){this.$apBody.style.transition="none",this.$apList.style.border="none";var t=document.createElement("style");t.rel="stylesheet",t.innerHTML=".acbp-move-box{width:100%;height:100%;position:absolute;left:0;top:0;cursor:move;}.acbp-ctrl-bar{width:100%;height:100%;display:flex;flex-direction:column;justify-content:space-around;align-items:center;}.acbp-ctrl-bar .acbp-ctrl-btn{display:inline-block;margin:0 auto;width:10px;height:10px;border-radius:50%;cursor:pointer;flex-shrink:0;z-index:999;transition: background-color .2s}.acbp-ctrl-bar .acbp-ctrl-btn.minimize{background-color:#8BD7E2;}.acbp-ctrl-bar .acbp-ctrl-btn.minimize:hover{background-color:#00BBCD;}.acbp-ctrl-bar .acbp-ctrl-btn.maximize{background-color:#96D6BF;}.acbp-ctrl-bar .acbp-ctrl-btn.maximize:hover{background-color:#1BB775;}.acbp-ctrl-bar .acbp-ctrl-btn.close{background-color:#E69EB2;}.acbp-ctrl-bar .acbp-ctrl-btn.close:hover{background-color:#E42D54;}.acbp-note-container{width:30px;height:30px;position:absolute;right:50%;bottom:50%;margin:0 -15px -15px 0;}.acbp-note-container.playing .acbp-note{display:block;}.acbp-note-container .acbp-note{display:none;opacity:0;width:16px;height:16px;position:absolute;z-index:999;}.acbp-note-container .acbp-note .icon{width:100%;height:100%;}.acbp-note-container #acbp-note1{animation:acbp-note-move-left1 2s linear 0s infinite normal;}@keyframes acbp-note-move-left1{0%{left:0;top:0;opacity:0;}50%{opacity:1;transform:rotate(9deg);}100%{left:200px;top:-90px;opacity:0;}}@keyframes acbp-note-move-right1{0%{right:0;top:0;opacity:0;}50%{opacity:1;transform:rotate(9deg);}100%{right:200px;top:-90px;opacity:0;}}.acbp-note-container #acbp-note2{animation:acbp-note-move-left2 2s linear 0.4s infinite normal;}@keyframes acbp-note-move-left2{0%{left:0;top:0;opacity:0;}50%{opacity:1;transform:rotate(-9deg);}100%{left:200px;top:-80px;opacity:0;}}@keyframes acbp-note-move-right2{0%{right:0;top:0;opacity:0;}50%{opacity:1;transform:rotate(-9deg);}100%{right:200px;top:-80px;opacity:0;}}.acbp-note-container #acbp-note3{animation:acbp-note-move-left3 2s linear 0.7s infinite normal;}@keyframes acbp-note-move-left3{0%{left:0;top:0;opacity:0;}50%{opacity:1;transform:rotate(9deg);}100%{left:200px;top:-70px;opacity:0;}}@keyframes acbp-note-move-right3{0%{right:0;top:0;opacity:0;}50%{opacity:1;transform:rotate(9deg);}100%{right:200px;top:-70px;opacity:0;}}",document.head.appendChild(t)}},{key:"initControllerBar",value:function(){var t=this,e=this.$ap.querySelector(".aplayer-miniswitcher"),o=e.parentNode||e.parentElement;o.removeChild(e),e=document.createElement("div"),e.className="aplayer-miniswitcher",o=o.appendChild(e),this.initPlayerMove(e),e=document.createElement("div"),e.className="acbp-ctrl-bar",o.appendChild(e);var a=document.createElement("span");a.className="acbp-ctrl-btn minimize",a.addEventListener("click",function(e){t.minimizePlayer(),e.stopPropagation()}),e.appendChild(a);var i=document.createElement("span");i.className="acbp-ctrl-btn maximize",i.addEventListener("click",function(e){t.maximizePlayer(e),e.stopPropagation()}),e.appendChild(i);var n=document.createElement("span");n.className="acbp-ctrl-btn close",n.addEventListener("click",function(e){t.player.destroy(),e.stopPropagation()}),e.appendChild(n)}},{key:"initPlayerMove",value:function(t){var e=this,o=document.createElement("div");o.className="acbp-move-box",o.addEventListener("mousedown",function(t){document.body.style.cursor="move";var o=e.$ap.style.left||"0",a=e.$ap.style.bottom||"0",i=t.clientX-parseInt(o,10),n=document.body.clientHeight-t.clientY-parseInt(a,10);window.onmousemove=function(t){e.movePlayer(t,e.$ap,e.$apBody,i,n)},window.onmouseup=function(t){document.body.style.cursor="default",e.playerStop(t),e.noteAutoControl(),window.onmousemove=window.onmouseup=void 0}}),t.appendChild(o)}},{key:"initPlayerEvent",value:function(){var t=this;this.player.on("listshow",function(){return setTimeout(function(){return t.playerStop()},500)}),this.player.on("play",function(){return t.noteAutoControl()}),this.player.on("pause",function(){return t.noteAutoControl()})}},{key:"movePlayer",value:function(t,e,o,a,i){this.event=t||window.event||this.event;var n=this.event.clientX-a,r=document.body.clientHeight-this.event.clientY-i;this.curStop.left=n,this.curStop.bottom=r,e.style.left=o.style.left=n+"px",e.style.bottom=o.style.bottom=r+"px"}},{key:"playerStop",value:function(t){var e=Math.max(66,this.$apBody.clientWidth)+18,o=Math.max(66,this.$ap.clientHeight),a=void 0;this.curStop.bottom<16?a="0":this.curStop.bottom+o+16>document.body.clientHeight&&(a=document.body.clientHeight-o),a&&(this.$ap.style.bottom=this.$apBody.style.bottom=a+"px");var i=void 0;this.curStop.left<16?i="0":this.curStop.left+e+16>document.body.clientWidth&&(i=document.body.clientWidth-e+18),i&&(this.$ap.style.left=this.$apBody.style.left=i+"px"),(a||i)&&(this.event=t||window.event||this.event,this.curStop.bottom=this.lastStop.bottom=a||document.body.clientHeight-this.event.clientY-o,this.curStop.left=this.lastStop.left=i||this.event.clientX-e)}},{key:"minimizePlayer",value:function(){var t=this;this.setPlayerMode("mini"),this.curStop.left+""=="0"&&this.curStop.bottom+""=="0"||(this.$ap.style.background="none",this.$apBody.style.transition="all .5s ease",this.$ap.style.left=this.$apBody.style.left="0px",this.$ap.style.bottom=this.$apBody.style.bottom="0px",this.lastStop=_extends({},this.curStop),this.curStop.left=this.curStop.bottom=0,setTimeout(function(){t.$apBody.style.transition="none",t.noteAutoControl()},500))}},{key:"maximizePlayer",value:function(t){var e=this;this.setPlayerMode("mini"===this.player.mode?"normal":"mini");var o=this.$apList.className.indexOf("aplayer-list-hide")>-1;o||(this.$apList.className="aplayer-list aplayer-list-hide"),this.$apBody.style.transition="all .5s ease",this.curStop.left+""=="0"&&this.curStop.bottom+""=="0"&&(this.$ap.style.left=this.$apBody.style.left=this.lastStop.left+"px",this.$ap.style.bottom=this.$apBody.style.bottom=this.lastStop.bottom+"px",this.curStop=_extends({},this.lastStop)),setTimeout(function(){e.$apBody.style.transition="none",e.$ap.style.background="#fff",o||(e.$apList.className="aplayer-list"),e.noteAutoControl(),e.playerStop(t)},500)}},{key:"initNote",value:function(){if(this.showNote){var t=document.createElement("div");t.className="acbp-note-container";for(var e=this.curStop.left>document.body.clientWidth>>1?"acbp-note-move-right":"acbp-note-move-left",o=1;o<4;o++){var a=document.createElement("div");a.id="acbp-note"+o,a.className="acbp-note",a.innerHTML='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="32" height="32"><path d="M1023.962 64.037c0-43.42-42.2-74.019-83.199-61.019L300.795 192.015c-26.6 8.4-44.8 33-44.8 60.999v522.83c-20.1-4.76-41.439-7.84-63.998-7.84C85.958 768.005 0 825.305 0 896.003S85.958 1024 191.997 1024s191.996-57.299 191.996-127.998V428.631l511.991-150.038v369.254c-20.1-4.76-41.44-7.84-63.999-7.84-106.038 0-191.996 57.299-191.996 127.998s85.958 127.997 191.996 127.997 191.997-57.299 191.997-127.997l-.02-703.968z"/></svg>',a.querySelector("svg path").style.fill=this.randomRGBColor(),a.style.animationName=e+o,t.appendChild(a)}this.$ap.querySelector(".aplayer-pic").appendChild(t)}}},{key:"noteAutoControl",value:function(){if(this.showNote){var t=this.$ap.querySelector(".acbp-note-container");if(t){t.className=this.player.audio.paused?"acbp-note-container":"acbp-note-container playing";for(var e=this.curStop.left>document.body.clientWidth>>1?"acbp-note-move-right":"acbp-note-move-left",o=1;o<4;o++){var a=document.getElementById("acbp-note"+o);a.style.animationName=e+o,this.player.audio.paused||(a.querySelector("svg path").style.fill=this.randomRGBColor())}}else this.initNote(),this.player.audio.paused||(this.$ap.querySelector(".acbp-note-container").className="acbp-note-container playing")}}},{key:"setPlayerMode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal";this.$apList.style.display="block";var e=this.$apList.querySelector("ol");if("normal"===t){var o=this.player.options.listMaxHeight;this.$apList.style.maxHeight=o||"250px",e.style.maxHeight=o||"250px"}else this.$apList.style.maxHeight="0px",e.style.maxHeight="0px";this.player.setMode(t)}},{key:"randomRGBColor",value:function(){return"rgb("+Math.round(255*Math.random())+","+Math.round(255*Math.random())+","+Math.round(255*Math.random())+")"}},{key:"consoleInfo",value:function(){console.log("\n %c APlayer-Control-Bar-Plugin %c https://github.com/snwjas/Aplayer-ControlBarPlugin \n","color:#fadfa3;background:#030307;padding:5px 0;","background:#fadfa3;padding:5px 0;")}}]),t}();
