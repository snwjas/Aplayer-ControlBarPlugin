"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},_createClass=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),Movadsorbent=function(){function t(e,o,n){_classCallCheck(this,t),this.lastStop={left:0,bottom:0},this.curStop={left:0,bottom:0},this.player=e,this.showNote=o,this.event=n,this.initPlayerStyle(),this.initControllerBar(),this.initNote(),this.initPlayerEvent(),this.consoleInfo()}return _createClass(t,[{key:"initPlayerStyle",value:function(){this.player.container.querySelector(".aplayer-body").style.transition="none",this.player.container.querySelector(".aplayer-list").style.border="none";var t=document.createElement("style");t.rel="stylesheet",t.innerHTML=".acbp-move-box{width:100%;height:100%;position:absolute;left:0;top:0;cursor:move;}.acbp-ctrl-bar{width:100%;height:100%;display:flex;flex-direction:column;justify-content:space-around;align-items:center;}.acbp-ctrl-bar .acbp-ctrl-btn{display:inline-block;margin:0 auto;width:10px;height:10px;border-radius:50%;cursor:pointer;flex-shrink:0;z-index:999;}.acbp-ctrl-bar .acbp-ctrl-btn.minimize{background-color:#8BD7E2;}.acbp-ctrl-bar .acbp-ctrl-btn.minimize:hover{background-color:#00BBCD;}.acbp-ctrl-bar .acbp-ctrl-btn.maximize{background-color:#96D6BF;}.acbp-ctrl-bar .acbp-ctrl-btn.maximize:hover{background-color:#1BB775;}.acbp-ctrl-bar .acbp-ctrl-btn.close{background-color:#E69EB2;}.acbp-ctrl-bar .acbp-ctrl-btn.close:hover{background-color:#E42D54;}.acbp-note-container{width:30px;height:30px;position:absolute;right:50%;bottom:50%;margin:0 -15px -15px 0;}.acbp-note-container.playing .acbp-note{display:block;}.acbp-note-container .acbp-note{display:none;opacity:0;width:16px;height:16px;position:absolute;z-index:999;}.acbp-note-container .acbp-note .icon{width:100%;height:100%;}.acbp-note-container #acbp-note1{animation:acbp-note-move-left1 2s linear 0s infinite normal;}@keyframes acbp-note-move-left1{0%{left:0;top:0;opacity:0;}50%{opacity:1;transform:rotate(9deg);}100%{left:200px;top:-90px;opacity:0;}}@keyframes acbp-note-move-right1{0%{right:0;top:0;opacity:0;}50%{opacity:1;transform:rotate(9deg);}100%{right:200px;top:-90px;opacity:0;}}.acbp-note-container #acbp-note2{animation:acbp-note-move-left2 2s linear 0.4s infinite normal;}@keyframes acbp-note-move-left2{0%{left:0;top:0;opacity:0;}50%{opacity:1;transform:rotate(-9deg);}100%{left:200px;top:-80px;opacity:0;}}@keyframes acbp-note-move-right2{0%{right:0;top:0;opacity:0;}50%{opacity:1;transform:rotate(-9deg);}100%{right:200px;top:-80px;opacity:0;}}.acbp-note-container #acbp-note3{animation:acbp-note-move-left3 2s linear 0.7s infinite normal;}@keyframes acbp-note-move-left3{0%{left:0;top:0;opacity:0;}50%{opacity:1;transform:rotate(9deg);}100%{left:200px;top:-70px;opacity:0;}}@keyframes acbp-note-move-right3{0%{right:0;top:0;opacity:0;}50%{opacity:1;transform:rotate(9deg);}100%{right:200px;top:-70px;opacity:0;}}",document.head.appendChild(t)}},{key:"initControllerBar",value:function(){var t=this.player.container.querySelector(".aplayer-miniswitcher"),e=t.parentNode||t.parentElement;e.removeChild(t),t=document.createElement("div"),t.className="aplayer-miniswitcher",e=e.appendChild(t),this.initPlayerMove(t),t=document.createElement("div"),t.className="acbp-ctrl-bar",e.appendChild(t),this.initMinimizeButton(t),this.initMaximizeButton(t),this.initCloseButton(t)}},{key:"initMinimizeButton",value:function(t){var e=this,o=document.createElement("span");o.className="acbp-ctrl-btn minimize",o.addEventListener("click",function(t){e.minimizePlayer(),t.stopPropagation()}),t.appendChild(o)}},{key:"initMaximizeButton",value:function(t){var e=this,o=document.createElement("span");o.className="acbp-ctrl-btn maximize",o.addEventListener("click",function(t){e.maximizePlayer(t),t.stopPropagation()}),t.appendChild(o)}},{key:"initCloseButton",value:function(t){var e=this,o=document.createElement("span");o.className="acbp-ctrl-btn close",o.addEventListener("click",function(t){e.player.destroy(),t.stopPropagation()}),t.appendChild(o)}},{key:"initPlayerMove",value:function(t){var e=this,o=document.createElement("div");o.className="acbp-move-box",o.addEventListener("mousedown",function(t){document.body.style.cursor="move";var o=e.player.container,n=e.player.container.querySelector(".aplayer-body"),a=o.style.left||"0",i=o.style.bottom||"0",r=t.clientX-parseInt(a,10),l=document.body.clientHeight-t.clientY-parseInt(i,10);window.onmousemove=function(t){e.movePlayer(t,o,n,r,l)},window.onmouseup=function(t){document.body.style.cursor="default",e.playerStop(t),e.noteAutoControl(),window.onmousemove=window.onmouseup=void 0}}),t.appendChild(o)}},{key:"initPlayerEvent",value:function(){var t=this;this.player.on("listshow",function(){return setTimeout(function(){return t.playerStop()},500)}),this.player.on("play",function(){return t.noteAutoControl()}),this.player.on("pause",function(){return t.noteAutoControl()})}},{key:"movePlayer",value:function(t,e,o,n,a){this.event=t||window.event||this.event;var i=this.event.clientX-n,r=document.body.clientHeight-this.event.clientY-a;this.curStop.left=i,this.curStop.bottom=r,e.style.left=o.style.left=i+"px",e.style.bottom=o.style.bottom=r+"px"}},{key:"playerStop",value:function(t){var e=this.player.container,o=this.player.container.querySelector(".aplayer-body"),n=Math.max(66,o.clientWidth)+18,a=Math.max(66,e.clientHeight),i=void 0;this.curStop.bottom<16?i="0":this.curStop.bottom+a+16>document.body.clientHeight&&(i=document.body.clientHeight-a),i&&(e.style.bottom=o.style.bottom=i+"px");var r=void 0;this.curStop.left<16?r="0":this.curStop.left+n+16>document.body.clientWidth&&(r=document.body.clientWidth-n+18),r&&(e.style.left=o.style.left=r+"px"),(i||r)&&(this.event=t||window.event||this.event,this.curStop.bottom=this.lastStop.bottom=i||document.body.clientHeight-this.event.clientY-a,this.curStop.left=this.lastStop.left=r||this.event.clientX-n)}},{key:"minimizePlayer",value:function(){var t=this;if(this.setPlayerMode("mini"),this.curStop.left+""!="0"||this.curStop.bottom+""!="0"){var e=this.player.container,o=this.player.container.querySelector(".aplayer-body");e.style.background="none",o.style.transition="all .5s ease",e.style.left=o.style.left="0px",e.style.bottom=o.style.bottom="0px",this.lastStop=_extends({},this.curStop),this.curStop.left=this.curStop.bottom=0,setTimeout(function(){o.style.transition="none",t.noteAutoControl()},500)}}},{key:"maximizePlayer",value:function(t){var e=this;this.setPlayerMode("mini"===this.player.mode?"normal":"mini");var o=this.player.container,n=this.player.container.querySelector(".aplayer-body"),a=this.player.container.querySelector(".aplayer-list"),i=a.className.indexOf("aplayer-list-hide")>-1;i||(a.className="aplayer-list aplayer-list-hide"),n.style.transition="all .5s ease",this.curStop.left+""=="0"&&this.curStop.bottom+""=="0"&&(o.style.left=n.style.left=this.lastStop.left+"px",o.style.bottom=n.style.bottom=this.lastStop.bottom+"px",this.curStop=_extends({},this.lastStop)),setTimeout(function(){n.style.transition="none",o.style.background="#fff",i||(a.className="aplayer-list"),e.noteAutoControl(),e.playerStop(t)},500)}},{key:"initNote",value:function(){if(this.showNote){var t=document.createElement("div");t.className="acbp-note-container";for(var e=this.curStop.left>document.body.clientWidth>>1?"acbp-note-move-right":"acbp-note-move-left",o=1;o<4;o++){var n=document.createElement("div");n.id="acbp-note"+o,n.className="acbp-note",n.innerHTML='<svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="32" height="32"><path d="M1023.962 64.037c0-43.42-42.2-74.019-83.199-61.019L300.795 192.015c-26.6 8.4-44.8 33-44.8 60.999v522.83c-20.1-4.76-41.439-7.84-63.998-7.84C85.958 768.005 0 825.305 0 896.003S85.958 1024 191.997 1024s191.996-57.299 191.996-127.998V428.631l511.991-150.038v369.254c-20.1-4.76-41.44-7.84-63.999-7.84-106.038 0-191.996 57.299-191.996 127.998s85.958 127.997 191.996 127.997 191.997-57.299 191.997-127.997l-.02-703.968z"/></svg>',n.querySelector("svg path").style.fill=this.randomRGBColor(),n.style.animationName=e+o,t.appendChild(n)}this.player.container.querySelector(".aplayer-pic").appendChild(t)}}},{key:"noteAutoControl",value:function(){if(this.showNote){var t=this.player.container.querySelector(".acbp-note-container");if(t){t.className=this.player.audio.paused?"acbp-note-container":"acbp-note-container playing";for(var e=this.curStop.left>document.body.clientWidth>>1?"acbp-note-move-right":"acbp-note-move-left",o=1;o<4;o++){var n=document.getElementById("acbp-note"+o);n.style.animationName=e+o,this.player.audio.paused||(n.querySelector("svg path").style.fill=this.randomRGBColor())}}else this.initNote(),this.player.audio.paused||(this.player.container.querySelector(".acbp-note-container").className="acbp-note-container playing")}}},{key:"setPlayerMode",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"normal",e=this.player.container.querySelector(".aplayer-list"),o=e.querySelector("ol");if(e.style.display="block","normal"===t){var n=this.player.options.listMaxHeight;e.style.maxHeight=n||"250px",o.style.maxHeight=n||"250px"}else e.style.maxHeight="0px",o.style.maxHeight="0px";this.player.setMode(t)}},{key:"randomRGBColor",value:function(){return"rgb("+Math.round(236*Math.random())+","+Math.round(236*Math.random())+","+Math.round(236*Math.random())+")"}},{key:"consoleInfo",value:function(){console.log("\n %c APlayer-Control-Bar-Plugin %c https://github.com/snwjas/Aplayer-ControlBarPlugin \n","color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;")}}]),t}();
